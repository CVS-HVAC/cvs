<style>
.hg-table{
border-collapse: collapse;
}
.hg-table > thead > tr > th,
.hg-table > tbody > tr > th,
.hg-table > tfoot > tr > th,
.hg-table > thead > tr > td,
.hg-table > tbody > tr > td,
.hg-table > tfoot > tr > td {
  padding: 8px;
  line-height: 1.42857143;
  vertical-align: middle;
  border:0.1em dotted #000000; 
  background-color:#ffffff; 
}
.print-format div, .print-format p, 
.print-format h1,.print-format h2,.print-format h3,.print-format h4, .print-format h5  {
	font-family: Monospace;
	font-size: 8pt;
	vertical-align: middle;
}	
</style>

<div id="header-html" class="hidden-pdf">
<!-- {%= frappe.boot.letter_heads[frappe.defaults.get_default("letter_head")] %} -->
    {%= frappe.boot.letter_heads[filters.letter_head] %}
</div>
<h4 class="text-center">{%= __("Statement of Account") %}</h4>
<div class="row">        
     <div class="col-xs-12">            
        <div class="row">
            <div class="col-xs-12 text-left">To, <br><h4>{%= filters.customer || filters.supplier %}</h4></div>
        </div>
        <div class="row">
            <div class="col-xs-12 text-left">{%= filters.party_address %}</div>
        </div>  
        <div class="row">
            <div class="col-xs-12 text-left">Please find the Statement of A/C as of {%= dateutil.str_to_user(filters.report_date) %}</div>
        </div>         
       
    </div>
</div>


{% var balance_row = data.slice(-1).pop() ; 
	   var range1 = report.columns[10].label;
	   var range2 = report.columns[11].label;
	   var range3 = report.columns[12].label;
	   var range4 = report.columns[13].label;

%}

{% if(__(report.report_name) == "Accounts Payable") { %}
	{%
	   var range1 = report.columns[12].label;
	   var range2 = report.columns[13].label;
	   var range3 = report.columns[14].label;
	   var range4 = report.columns[15].label;
	%}
{% } %}

<h5>Aging</h5>
<table class="hg-table">
	<thead>
		<tr>
			{% if(__(report.report_name) == "CVS Statement of Accounts" || __(report.report_name) == "Accounts Receivable" || __(report.report_name) == "Accounts Payable") { %}
				<th style="width: 15%">{%= __(" ") %}</th>
				<th style="width: 12%">{%= __("Not Due") %}</th>
				<th style="width: 12%">{%= __(range1) %}</th>
				<th style="width: 12%">{%= __(range2) %}</th>
				<th style="width: 12%">{%= __(range3) %}</th>
				<th style="width: 12%">{%= __(range4) %}</th>
				<th style="width: 15%">{%= __("Total") %}</th>
			{% } %}
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>{%= __("Total Receivable") %}</td>
			<td>{%= format_currency(balance_row[range1]) %}</td>
			<td>{%= format_currency(balance_row[range1]) %}</td>
			<td>{%= format_currency(balance_row[range2]) %}</td>
			<td>{%= format_currency(balance_row[range3]) %}</td>
			<td>{%= format_currency(balance_row[range4]) %}</td>
			<td>{%= format_currency(flt(data[data.length-1][__("Balance")]), data[data.length-1]["currency"]) %}</td>
		</tr>
			<td>{%= __("PDC") %}</td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td>{%= format_currency(flt(data[data.length-1][__("PDC Amount")]), data[data.length-1]["currency"]) %}</td>
		<tr>
			<td>{%= __("Cheques Required") %}</td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td>{%= format_currency(flt(data[data.length-1][__("Balance")]-data[data.length-1][__("PDC Amount")]), data[data.length-1]["currency"]) %}</td>
		</tr>
	</tbody>
</table>

<div class="row">        
     <div class="col-xs-6">  </div>
     <div class="col-xs-6 text-right">(Amount in {%= data[0][__("currency")] || "" %})</div>
</div>

<table class="hg-table table-responsive">
	<thead>
		<tr>
			{% if(__(report.report_name) == "CVS Statement of Accounts" || __(report.report_name) == "Accounts Receivable" || __(report.report_name) == "Accounts Payable") { %}
				<th style="width: 14%; word-break: keep-all;">{%= __("Date") %}</th>
				<th style="width: 14%; word-break: keep-all;">{%= __("Ref") %}</th>
				<th style="width: 37%; word-break: break-word;">{%= __("Particular") %}</th>
				<th class="text-right" style="width: 10%; word-break: keep-all;">{%= __("Invoiced Amount") %}</th>
				<th class="text-right" style="width: 7.5%; word-break: keep-all;">{%= __("Paid Amount") %}</th>
				<th class="text-right" style="width: 10%; word-break: keep-all;">{%= __("Outstanding Amount") %}</th>
				<th class="text-right" style="width: 10%; word-break: keep-all;">{%= __("Balance") %}</th>
				<th class="text-right" style="width: 7.5%; word-break: keep-all;">{%= __("PDC Amount") %}</th>
			{% } else { %}
				<th style="width: 40%">{%= __("Party") %}</th>
				<th style="width: 15%">{%= __("Total Invoiced Amount") %}</th>
				<th style="width: 15%">{%= __("Total Paid Amount") %}</th>
				<th style="width: 15%">{%= __("Total Outstanding Amount") %}</th>
				<th style="width: 15%">{%= __("Total Balance Amount") %}</th>
				<th style="width: 15%">{%= __("Total PDC Amount") %}</th>
			{% } %}
		</tr>
	</thead>
	<tbody>
		{% for(var i=0, l=data.length; i<l; i++) { %}
			<tr>
			{% if(__(report.report_name) == "CVS Statement of Accounts" || __(report.report_name) == "Accounts Receivable" || __(report.report_name) == "Accounts Payable") { %}
				{% if(data[i][__("Customer")] || data[i][__("Supplier")]) { %}

					<td>{%= dateutil.str_to_user(data[i][__("Posting Date")]) %}</td>
					<td>{%= data[i][__("Voucher No")] %}</td>
					{% if(data[i][__("Bill No")]) { %}
					<td>Invoice #{%= data[i][__("Bill No")] %} dated {%= data[i][__("Bill Date")] %}</td>
					{% } else { %}
					<td>{%= data[i][__("Remarks")] %}</td>
					{% } %}
					<td style="text-align: right">
						{%= format_currency(data[i][__("Invoiced Amount")], data[i]["currency"]) %}</td>
					<td style="text-align: right">
						{%= format_currency(data[i][__("Paid Amount")], data[i]["currency"]) %}</td>
					<td style="text-align: right">
						{%= format_currency(data[i][__("Outstanding Amount")], data[i]["currency"]) %}</td>
					<td style="text-align: right">
						{%= format_currency(flt(data[i][__("Balance")]), data[i]["currency"]) %}</td>
					<td style="text-align: right">
						{%= format_currency(data[i][__("PDC Amount")], data[i]["currency"]) %}</td>

				{% } else { %}
					<td></td>
					<td></td>
					<td><b>{%= __("Total") %}</b></td>
					<td style="text-align: right">
						{%= format_currency(data[i][__("Invoiced Amount")]) %}</td>
					<td style="text-align: right">
						{%= format_currency(data[i][__("Paid Amount")]) %}</td>
					<td style="text-align: right">
						{%= format_currency(data[i][__("Outstanding Amount")]) %}</td>
					<td style="text-align: right">
						{%= format_currency(flt(data[i][__("Balance")]), data[i]["currency"]) %}</td>
					<td style="text-align: right">
						{%= format_currency(data[i][__("PDC Amount")], data[i]["currency"]) %}</td>

				{% } %}
			{% } else { %}
				{% if(data[i][__("Customer")] || data[i][__("Supplier")]|| "&nbsp;") { %}
					{% if((data[i][__("Customer")] || data[i][__("Supplier")]) != __("'Total'")) { %}
						<td>{%= data[i][__("Customer")] || data[i][__("Supplier")] %}
						<br>{%= __("Remarks") %}: {%= data[i][__("Remarks")] %}</td>
					{% } else { %}
						<td><b>{%= __("Total") %}</b></td>
					{% } %}
					<td style="text-align: right">{%= format_currency(data[i][__("Total Invoiced Amt")]) %}</td>
					<td style="text-align: right">{%= format_currency(data[i][__("Total Paid Amt")]) %}</td>
					<td style="text-align: right">{%= format_currency(data[i][__("Total Outstanding Amt")]) %}</td>
					<td style="text-align: right">{%= format_currency(data[i][__("Total Balance Amt")]) %}</td>
					<td style="text-align: right">{%= format_currency(data[i][__("Total PDC Amt")]) %}</td>

				{% } %}
			{% } %}
			</tr>
		{% } %}
	</tbody>
</table>

<br>
<p> <h5>Yours Sincerely,
<br><label>For {%= filters.company %}</label></h5>
</p>

<div id="footer-html" class="visible-pdf">
	<p class="text-center small page-number visible-pdf">
		Page <span class="page"></span> of <span class="topage"></span>
		<p class="text-right text-muted small">Printed on {%= dateutil.str_to_user(dateutil.get_datetime_as_string()) %}</p>
	</p>
</div>
<div id="page-size" class="hidden">A4</div>
<div id="orientation" class="hidden">Portrait</div>

