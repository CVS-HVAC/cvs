<style>
    table {
        table-layout: fixed;
    }
    table th, table td {
            overflow: hidden;
	    white-space: normal;
	    word-wrap: break-word;
    }
    table th{
	text-align: center;
    }

.print-format table, .print-format tr, 
.print-format td, .print-format div, .print-format p,
.print-format span
{
        font-family: Tahoma, sans-serif;
}

@media print {
   thead {display: table-header-group;}
   .print-format {
        font-family: Tahoma, sans-serif;
    }
}
</style>
<div style="min-height:30px; max-height:30px;">
<h4 class="text-left">{%= __("Customer ") %} : {%= filters.customer %}</h4>
<h5 class="text-left">{%= __("Statement of Account as of ") %} {%= moment(filters.report_date).format('MMMM Do, YYYY') %}</h5>

{% var balance_row = data.slice(-1).pop() ; 
	   var range0 = report.columns[8].label;
	   var range1 = report.columns[9].label;
	   var range2 = report.columns[10].label;
	   var range3 = report.columns[11].label;
	   var range4 = report.columns[12].label;

%}
<div style="min-height:30px; max-height:30px;">
{% if(balance_row) { %}
<table class="table table-bordered table-condensed table-sm small">
	<caption class="text-right">(Amount in {%= data[0][__("currency")] || "" %})</caption>
	<thead>
		<tr>
			<th>{%= __(" ") %}</th>
			<th>{%= __(range1) %}</th>
			<th>{%= __(range2) %}</th>
			<th>{%= __(range3) %}</th>
			<th>{%= __(range4) %}</th>
			<th>{%= __("Total") %}</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>{%= __("Total Outstanding") %}</td>
			<td class="text-right">{%= format_currency(balance_row[range1]) %}</td>
			<td class="text-right">{%= format_currency(balance_row[range2]) %}</td>
			<td class="text-right">{%= format_currency(balance_row[range3]) %}</td>
			<td class="text-right">{%= format_currency(balance_row[range4]) %}</td>
			<td class="text-right">
				{%= format_currency(flt(balance_row[__("Outstanding Amount")]), data[data.length-1]["currency"]) %}
				</td>
		</tr>
			<td>{%= __("PDC/LC") %}</td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td class="text-right">
				{%= format_currency(flt(balance_row[__("PDC/LC Amount")]), data[data.length-1]["currency"]) %}
			</td>
	</tbody>
	<thead>
		<tr>
			<th>{%= __("Cheques Required") %}</th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th class="text-right">
				{%= format_currency(flt(balance_row[__("Outstanding Amount")]-balance_row[__("PDC/LC Amount")]), data[data.length-1]["currency"]) %}</th>
		</tr>
	</thead>

</table>
{% } %}
<div style="min-height:25px; max-height:25px;">
<table class="table table-bordered table-condensed table-sm small">
        <colgroup>
            <col style="width: 18mm;">
            <col style="width: 20mm;">
            <col style="width: 17mm;">
            <col style="width: 20mm;">
            <col style="width: 22mm;">
            <col style="width: 20mm;">
            <col style="width: 18mm;">
            <col style="width: 22mm;">
            <col style="width: 17mm">
        </colgroup>

	<thead>
		<tr>
			<th>{%= __("Date") %}</th>
			<th>{%= __("CVS Invoice No.") %}</th>
			<th>{%= __("Invoiced Amount") %}</th>
			<th>{%= __("Outstanding Amount") %}</th>
			<th>{%= __("Customer LPO No.") %}</th>
			<th>{%= __("Delivery Note") %}</th>
			<th>{%= __("PDC/LC Date") %}</th>
			<th>{%= __("PDC/LC Ref") %}</th>
			<th>{%= __("PDC/LC Amount") %}</th>
		</tr>
	</thead>
	<tbody>
	{% for(var i=0, l=data.length; i<l; i++) { %}
		<tr>
		{% if(data[i][__("Customer")] || data[i][__("Supplier")]) { %}

			<td>{%= frappe.datetime.str_to_user(data[i][__("Posting Date")]) %}</td>
			<td>
				{%=  data[i][__("Voucher No")] %}</td>
			<td class="text-right">
				{%= format_currency(data[i][__("Invoiced Amount")], data[i]["currency"]) %}</td>
			<td class="text-right">
				{%= format_currency(data[i][__("Outstanding Amount")], data[i]["currency"]) %}</td>
			<td>
				{%=  data[i][__("Customer LPO")] %}</td>
			<td>
				{%=  data[i][__("Delivery Note")] %}</td>
			<td>
				{%=  frappe.datetime.str_to_user(data[i][__("PDC/LC Date")]) %}</td>
			<td>
				{%=  data[i][__("PDC/LC Ref")] %}</td>
			<td class="text-right">
				{%= format_currency(data[i][__("PDC/LC Amount")], data[i]["currency"]) %}</td>

		{% } else { %}

		{% } %}
		</tr>
	{% } %}
	</tbody>
{% if(balance_row ) { %}
	<thead>
		<tr>
			<th></th>
			<th>{%= __("Total") %}</th>
			<th class="text-right">
				{%= format_currency(flt(balance_row[__("Invoiced Amount")]), data[data.length-1]["currency"]) %}
				</th>
			<th class="text-right">
				{%= format_currency(flt(balance_row[__("Outstanding Amount")]), data[data.length-1]["currency"]) %}
				</th>
			<th></th>
			<th></th>
			<th></th>
			<th></th>
			<th class="text-right">
				{%= format_currency(flt(balance_row[__("PDC/LC Amount")]), data[data.length-1]["currency"]) %}
				</th>
		</tr>
	</thead>
{% } %}
</table>
<p class="text-right text-muted">{{ __("Printed On ") }}{%= frappe.datetime.str_to_user(frappe.datetime.get_datetime_as_string()) %}</p>

